language: cpp

matrix:
  include:
    - os: linux
      compiler: gcc
      sudo: required
      dist: trusty
      env:
        - BASEEXE=stockfish-linux

    - os: osx
      compiler: gcc
      env:
        - COMPILER=g++-4.8
        - COMP=gcc
        - BASEEXE=stockfish-osx

branches:
  only:
    - fishnet

before_install:
  - if [ -f /proc/cpuinfo ] ; then cat /proc/cpuinfo; fi

script:
  - cd src
  - make clean && make profile-build ARCH=x86-64 EXE=../$BASEEXE-x86_64
  - make clean && make profile-build ARCH=x86-64-modern EXE=../$BASEEXE-x86_64-modern
  - make clean && make build ARCH=x86-64-bmi2 EXE=../$BASEEXE-x86_64-bmi2
  - cd ..
  - ls -lh
